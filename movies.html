<!DOCTYPE html>
<html>
<head>
  <title>Movie Voting</title>
</head>
<body>
  <input id="movieUrl" placeholder="Image URL" />
  <button onclick="addMovie()">Upload Movie</button>
  <div id="moviesContainer"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    function addMovie() {
      const imageUrl = document.getElementById('movieUrl').value;
      socket.emit('movie:add', imageUrl);
      document.getElementById('movieUrl').value = '';
    }

    function voteMovie(id) {
      socket.emit('movie:vote', id);
    }

    function deleteMovie(id) {
      socket.emit('movie:delete', id);
    }

    socket.emit('movie:getVotes');

    socket.on('movie:updateVotes', function(movies) {
      const container = document.getElementById('moviesContainer');
      container.innerHTML = '';
      movies.forEach(movie => {
        const div = document.createElement('div');
        div.innerHTML = `
          <img src="${movie.image}" width="100" /><br />
          Votes: ${movie.votes} <br />
          <button onclick="voteMovie('${movie.id}')">Vote</button>
          ${movie.uploaded ? `<button onclick="deleteMovie('${movie.id}')">Delete</button>` : ''}
        `;
        container.appendChild(div);
      });
    });
  </script>
</body>
</html>
